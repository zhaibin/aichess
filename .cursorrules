# AIChess 项目准则

## 项目信息
- 项目名：AIChess
- 域名：aichess.win
- 技术栈：Cloudflare Workers + Durable Objects + Workers AI
- 语言：TypeScript

## 核心原则

### 1. 文档管理
- ✅ 文档已完备，**不再新增文档**
- ✅ 只维护现有文档（README.md, QUICKSTART.md, DEPLOY.md, DEVELOPMENT.md, USAGE.md, CHANGELOG.md）
- ✅ 代码变更时同步更新相关文档
- ✅ 重要变更更新CHANGELOG.md

### 2. 自动化流程
- ✅ 每次代码变更自动部署到Cloudflare Workers
- ✅ 每次变更自动提交Git（本地）
- ✅ 重大变动推送到GitHub（需用户确认）

### 3. 代码规范
- TypeScript严格模式
- 使用ESLint和Prettier（如配置）
- 函数必须有注释
- 错误处理必须完善
- 保持代码简洁

### 4. 提交规范
- 使用语义化提交信息（中文）
- 格式：`类型: 简短描述`
- 类型：
  - 功能：新功能
  - 修复：Bug修复
  - 优化：性能优化
  - 文档：文档更新
  - 样式：UI样式调整
  - 重构：代码重构
  - 测试：测试相关
  - 配置：配置变更

### 5. 部署流程
1. 代码变更
2. 自动Git提交
3. 自动部署到Cloudflare
4. 验证部署成功
5. 如果是重大变更，询问是否推送GitHub

### 6. 重大变动定义
以下情况视为重大变动，需推送GitHub：
- 新增核心功能
- 破坏性变更
- 安全修复
- 性能重大优化
- API变更
- 数据结构变更

### 7. 开发工作流

#### 修改代码后
```bash
# 自动执行：
git add .
git commit -m "类型: 描述"
npm run deploy
# 如果是重大变动，询问用户是否：git push origin main
```

#### 本地测试
```bash
npm run dev  # 本地开发
```

#### 查看日志
```bash
npm run tail  # 实时日志
```

### 8. 项目结构（禁止改动）
```
AiChess/
├── src/              # 源代码
├── *.md              # 文档（只维护不新增）
├── wrangler.toml     # Cloudflare配置
├── package.json      # 依赖
└── .cursorrules      # 本文件
```

### 9. AI工作指南

#### 修改代码时
1. 理解需求
2. 修改相关代码
3. 更新相关文档（如CHANGELOG.md）
4. **自动提交Git**
5. **自动部署**
6. 判断是否重大变动
7. 如是重大变动，询问用户是否推送GitHub

#### 响应用户时
- 直接执行，不询问简单操作
- 简洁回复，避免冗长
- 中文交流
- 只在重大变动时确认GitHub推送

#### 禁止操作
- ❌ 创建新文档文件
- ❌ 删除现有文档
- ❌ 不经用户确认推送GitHub
- ❌ 修改项目结构

#### 必须操作
- ✅ 代码变更后自动Git提交
- ✅ 代码变更后自动部署
- ✅ 更新CHANGELOG.md（如有必要）
- ✅ 保持代码质量

### 10. 文件清单（只维护）
- README.md - 项目介绍
- QUICKSTART.md - 快速开始
- DEPLOY.md - 部署指南
- DEVELOPMENT.md - 开发文档
- USAGE.md - 使用指南
- CHANGELOG.md - 更新日志
- PROJECT_SUMMARY.md - 项目总结
- LICENSE - 许可证

### 11. Git提交模板
```
功能: 添加认输功能
修复: 修复AI超时问题
优化: 提升棋盘渲染性能
样式: 调整移动端布局
文档: 更新部署指南
```

### 12. 测试检查清单
- [ ] 本地运行无错误
- [ ] TypeScript编译通过
- [ ] 三种游戏模式都能正常运行
- [ ] 多语言切换正常
- [ ] 移动端显示正常
- [ ] AI能正常下棋

### 13. 性能要求
- Workers响应时间 < 200ms
- 首屏加载 < 2s
- 棋盘渲染流畅
- AI思考固定2秒

### 14. 安全要求
- 输入验证
- CORS正确配置
- 无XSS漏洞
- 无SQL注入（不适用）

### 15. 兼容性
- 现代浏览器（Chrome, Firefox, Safari, Edge）
- 移动端浏览器
- 屏幕宽度 >= 320px

## 日常操作示例

### 用户说："修复AI下棋bug"
AI应该：
1. 定位并修复bug
2. 测试修复
3. Git提交："修复: 修复AI下棋逻辑错误"
4. 自动部署
5. 回复："已修复AI下棋bug并部署"

### 用户说："添加悔棋功能"
AI应该：
1. 实现悔棋功能
2. 更新CHANGELOG.md
3. Git提交："功能: 添加悔棋功能"
4. 自动部署
5. 询问："这是重大变动，是否推送到GitHub？"

### 用户说："调整按钮颜色"
AI应该：
1. 修改CSS
2. Git提交："样式: 调整按钮颜色"
3. 自动部署
4. 回复："已调整按钮颜色并部署"

## 记住
- **简洁高效**
- **自动化优先**
- **保持代码质量**
- **维护文档同步**
- **用户确认重大变更**

